{% extends "base.html" %}

{% block title %}GDPR Compliance - ANAGHA SOLUTION{% endblock %}

{% block content %}
<div class="page-header">
    <h1><i class="fas fa-gavel"></i> GDPR Compliance</h1>
</div>

<div class="form-container">
    <h2>GDPR Compliance Statement</h2>
    <p>ANAGHA SOLUTION is committed to GDPR compliance and protecting your data privacy rights.</p>
    
    <h2>Data Protection Measures</h2>
    <ul>
        <li><strong>Encryption:</strong> All data is encrypted in transit and at rest</li>
        <li><strong>Access Controls:</strong> Multi-tenant isolation ensures data separation</li>
        <li><strong>Regular Backups:</strong> Data is backed up regularly</li>
        <li><strong>Security Audits:</strong> Regular security assessments</li>
    </ul>
    
    <h2>Your Rights</h2>
    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0;">
        <h3>Right to Access</h3>
        <p>Request a copy of all personal data we hold about you.</p>
        <button class="btn btn-primary" onclick="requestDataAccess()">Request Data Access</button>
    </div>
    
    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0;">
        <h3>Right to Rectification</h3>
        <p>Correct any inaccurate personal data.</p>
        <button class="btn btn-primary" onclick="window.location.href='/settings'">Update My Data</button>
    </div>
    
    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0;">
        <h3>Right to Erasure</h3>
        <p>Request deletion of your personal data.</p>
        <button class="btn btn-danger" onclick="requestDataDeletion()">Request Data Deletion</button>
    </div>
    
    <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 15px 0;">
        <h3>Right to Data Portability</h3>
        <p>Export your data in a machine-readable format.</p>
        <button class="btn btn-primary" onclick="exportMyData()">Export My Data</button>
    </div>
    
    <h2>Data Processing</h2>
    <p>We process your data based on:</p>
    <ul>
        <li><strong>Consent:</strong> You consent to data processing by using our service</li>
        <li><strong>Contract:</strong> Processing necessary for service delivery</li>
        <li><strong>Legal Obligation:</strong> Compliance with applicable laws</li>
    </ul>
    
    <h2>Data Breach Notification</h2>
    <p>In the event of a data breach, we will notify affected users within 72 hours as required by GDPR.</p>
    
    <h2>Contact</h2>
    <p>For GDPR-related inquiries: gdpr@anaghasolution.com</p>
</div>

{% endblock %}

{% block extra_js %}
<script>
function requestDataAccess() {
    if (confirm('Request a copy of all your data? This will be sent to your registered email.')) {
        axios.post('/api/gdpr/request-access')
            .then(response => {
                if (response.data.success) {
                    showAlert('Data access request submitted. You will receive an email with your data.', 'success');
                }
            })
            .catch(error => {
                showAlert('Error: ' + (error.response?.data?.error || error.message), 'error');
            });
    }
}

function requestDataDeletion() {
    if (confirm('WARNING: This will permanently delete all your data including campaigns, leads, and recipients. This cannot be undone. Are you sure?')) {
        if (confirm('Are you absolutely certain? This action is irreversible.')) {
            axios.post('/api/gdpr/request-deletion')
                .then(response => {
                    if (response.data.success) {
                        showAlert('Data deletion request submitted. Your account will be deleted within 30 days.', 'success');
                    }
                })
                .catch(error => {
                    showAlert('Error: ' + (error.response?.data?.error || error.message), 'error');
                });
        }
    }
}

function exportMyData() {
    axios.get('/api/gdpr/export-data')
        .then(response => {
            if (response.data.success) {
                // Download JSON file
                const dataStr = JSON.stringify(response.data.data, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `my_data_${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                window.URL.revokeObjectURL(url);
                showAlert('Data exported successfully!', 'success');
            }
        })
        .catch(error => {
            showAlert('Error: ' + (error.response?.data?.error || error.message), 'error');
        });
}
</script>
{% endblock %}

